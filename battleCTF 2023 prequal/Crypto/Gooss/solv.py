import numpy as np
from scipy import linalg
import sympy as sp

Ciphertext = [1245115057305148164, 1195140205147730541, 2441940832124642988, 2441940832124642988, 1835524676869638124, 1404473868033353193, 272777109172255911, 672752034376118188, 324890781330979572, 3086023531811583439, 475309634185807521, 1195140205147730541, 2441940832124642988, 1578661367846445708, 2358921859155462327, 1099718459319293547, 773945458916291731, 78288818574073053, 2441940832124642988, 1578661367846445708, 1099718459319293547, 343816904985468003, 1195140205147730541, 2527132076695959961, 2358921859155462327, 2358921859155462327, 1099718459319293547, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 3291439457645322417]

sp.var("a,b,c,d,e")

eqs = []
for i,x in zip(Ciphertext,"battle"):
    eqs.append(sp.Eq(2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e, i))

s = sp.solve(eqs, [a,b,c,d,e])
sp.init_printing()
a, b, c, d, e = s[a], s[b], s[c], s[d], s[e]
print(a,b,c,d,e)

for i, x in enumerate("battle"):
    assert (2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e)==Ciphertext[i]

for i in Ciphertext:
    for x in range(256):
        if i == 2*a*pow(x,4)+b*pow(x,3)+c*pow(x,2)+d*x+e:
            print(chr(x), end="")
print()
